"use strict";(self.webpackChunkkarunjosyin=self.webpackChunkkarunjosyin||[]).push([[3970],{4768:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>r,contentTitle:()=>s,default:()=>l,frontMatter:()=>c,metadata:()=>i,toc:()=>o});var t=n(4848),d=n(8453);const c={},s=void 0,i={id:"Explained/RGW/RGW Data Layout",title:"RGW Data Layout",description:"RGW organizes its data into three different kinds:",source:"@site/docs/Explained/RGW/RGW Data Layout.md",sourceDirName:"Explained/RGW",slug:"/Explained/RGW/RGW Data Layout",permalink:"/docs/Explained/RGW/RGW Data Layout",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"cephExplainedSidebar",previous:{title:"Realm-Zonegroup-Zone",permalink:"/docs/Explained/RGW/Realm-Zonegroup-Zone"},next:{title:"RGW Command cheatsheet",permalink:"/docs/Explained/RGW/RGW Command cheatsheet"}},r={},o=[{value:"Metadata",id:"metadata",level:2},{value:"Bucket Index",id:"bucket-index",level:2},{value:"DATA",id:"data",level:2}];function b(e){const a={code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.p,{children:["RGW organizes its data into three different kinds:\n",(0,t.jsx)(a.strong,{children:"metadata"}),",   ",(0,t.jsx)(a.strong,{children:"bucket index"}),",    and  ",(0,t.jsx)(a.strong,{children:"data"}),"."]}),"\n",(0,t.jsx)(a.h2,{id:"metadata",children:"Metadata"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"This stores the information about user,bucket and bucket.instance"}),"\n",(0,t.jsx)(a.li,{children:"Commands to  view more information of  metadata :"}),"\n"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:'# radosgw-admin metadata list\n[\n    "account",\n    "bucket",\n    "bucket.instance",\n    "group",\n    "otp",\n    "roles",\n    "topic",\n    "user"\n]\n\n\n# radosgw-admin metadata list user\n[\n    "dashboard",\n    "kj"\n]\n\n\n# radosgw-admin metadata list bucket.instance\n[\n    "kjbucket:1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1",\n    "test:1847c1d2-a429-4a01-a65b-30eac3893e1e.245100.1"\n]\n\n\n\n# radosgw-admin metadata get bucket:kjbucket\n{\n    "key": "bucket:kjbucket",\n    "ver": {\n        "tag": "_m5AWN1VVZjnqa-E1NAj7OAk",\n        "ver": 1\n    },\n    "mtime": "2025-03-21T09:06:35.525451Z",\n    "data": {\n        "bucket": {\n            "name": "kjbucket",\n            "marker": "1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1",\n            "bucket_id": "1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1",\n            "tenant": "",\n            "explicit_placement": {\n                "data_pool": "",\n                "data_extra_pool": "",\n                "index_pool": ""\n            }\n        },\n        "owner": "kj",\n        "creation_time": "2025-03-21T09:06:32.339318Z",\n        "linked": true,\n        "has_bucket_info": false\n    }\n}\n\n\n\n\n# radosgw-admin metadata get bucket.instance:test:1847c1d2-a429-4a01-a65b-30eac3893e1e.245100.1\n{\n    "key": "bucket.instance:test:1847c1d2-a429-4a01-a65b-30eac3893e1e.245100.1",\n    "ver": {\n        "tag": "_00XBXnzgU9cr36dWeVjO2Z4",\n        "ver": 1\n    },\n    "mtime": "2025-03-21T09:28:13.878622Z",\n    "data": {\n        "bucket_info": {\n            "bucket": {\n                "name": "test",\n                "marker": "1847c1d2-a429-4a01-a65b-30eac3893e1e.245100.1",\n                "bucket_id": "1847c1d2-a429-4a01-a65b-30eac3893e1e.245100.1",\n                "tenant": "",\n                "explicit_placement": {\n                    "data_pool": "",\n                    "data_extra_pool": "",\n                    "index_pool": ""\n                }\n            },\n            "creation_time": "2025-03-21T09:28:13.845783Z",\n            "owner": "kj",\n            "flags": 0,\n            "zonegroup": "fc3a7e3c-e3dc-40a7-a0b8-dbedb7c094a7",\n            "placement_rule": "default-placement",\n            "has_instance_obj": false,\n            "quota": {\n                "enabled": false,\n                "check_on_raw": false,\n                "max_size": -1,\n                "max_size_kb": 0,\n                "max_objects": -1\n            },\n            "num_shards": 11,\n            "bi_shard_hash_type": 0,\n            "requester_pays": false,\n            "has_website": false,\n            "swift_versioning": false,\n            "swift_ver_location": "",\n            "index_type": 0,\n            "mdsearch_config": [],\n            "reshard_status": 0,\n            "new_bucket_instance_id": ""\n        },\n        "attrs": [\n            {\n                "key": "user.rgw.acl",\n                "val": "AgJvAAAAAwIMAAAAAgAAAGtqAgAAAGtqBANXAAAAAQEAAAACAAAAa2oPAAAAAQAAAAIAAABragUDMAAAAAICBAAAAAAAAAACAAAAa2oAAAAAAAAAAAICBAAAAA8AAAACAAAAa2oAAAAAAAAAAAAAAAAAAAAA"\n            }\n        ]\n    }\n}\n\n\n# radosgw-admin metadata get user:kj\n{\n    "key": "user:kj",\n    "ver": {\n        "tag": "_4mi3AJTONyzsGI-w_SfDj8v",\n        "ver": 1\n    },\n    "mtime": "2025-03-21T09:06:20.256664Z",\n    "data": {\n        "user_id": "kj",\n        "display_name": "kj",\n        "email": "",\n        "suspended": 0,\n        "max_buckets": 1000,\n        "subusers": [],\n        "keys": [\n            {\n                "user": "kj",\n                "access_key": "EFNY9U6JK5VW6EQHQHMM",\n                "secret_key": "P8taqzqGhk6keH71SxO3htotTcaZGHvCyjANzb1O",\n                "active": true,\n                "create_date": "2025-03-21T09:06:20.256386Z"\n            }\n        ],\n        "swift_keys": [],\n        "caps": [],\n        "op_mask": "read, write, delete",\n        "default_placement": "",\n        "default_storage_class": "",\n        "placement_tags": [],\n        "bucket_quota": {\n            "enabled": false,\n            "check_on_raw": false,\n            "max_size": -1,\n            "max_size_kb": 0,\n            "max_objects": -1\n        },\n        "user_quota": {\n            "enabled": false,\n            "check_on_raw": false,\n            "max_size": -1,\n            "max_size_kb": 0,\n            "max_objects": -1\n        },\n        "temp_url_keys": [],\n        "type": "rgw",\n        "mfa_ids": [],\n        "account_id": "",\n        "path": "/",\n        "create_date": "2025-03-21T09:06:20.253994Z",\n        "tags": [],\n        "group_ids": [],\n        "attrs": []\n    }\n}\n\n'})}),"\n",(0,t.jsxs)(a.p,{children:["These metadata information is stored in the xattr of the objects in ",(0,t.jsx)(a.em,{children:"rgw.meta"})," pool under different namespaces"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"# rados -p kerala.rgw.meta ls --all\nroot\t    .bucket.meta.test:1847c1d2-a429-4a01-a65b-30eac3893e1e.245100.2\nroot\t    .bucket.meta.kjbucket:1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1\nusers.keys\tDYLP684TRN99E0AGE9B3\nusers.uid\tdashboard\nusers.uid\tkj\nusers.uid\tkj.buckets\nroot\t    kjbucket\nroot\t    test\nusers.keys\tEFNY9U6JK5VW6EQHQHMM\nusers.uid\tdashboard.buckets\n"})}),"\n",(0,t.jsx)(a.h2,{id:"bucket-index",children:"Bucket Index"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["\n",(0,t.jsx)(a.p,{children:"The bucket index holds a KEY-VALUE map attached to RADOS objects"}),"\n"]}),"\n",(0,t.jsxs)(a.li,{children:["\n",(0,t.jsx)(a.p,{children:"When a bucket is created, it will create a bucket index object in rgw.buckets.index pool.\n(By default in newer versions, the shard number is 11, so it will be split into 11 shards)"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"# s3cmd mb  s3://kjbucket\nBucket 's3://kjbucket/' created\n\n# rados -p kerala.rgw.buckets.index ls\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.9\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.3\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.5\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.10\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.8\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.4\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.2\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.6\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.1\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.0\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.7\n"})}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["The index object itself does not contain any data. Look at the ",(0,t.jsx)(a.em,{children:"size"})," field :"]}),"\n"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"kerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.9 mtime 2025-03-21T04:06:35.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.3 mtime 2025-03-21T04:06:35.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.5 mtime 2025-03-21T04:06:35.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.10 mtime 2025-03-21T04:06:35.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.8 mtime 2025-03-21T04:06:35.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.4 mtime 2025-03-21T05:43:53.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.2 mtime 2025-03-21T04:06:35.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.6 mtime 2025-03-21T04:06:35.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.1 mtime 2025-03-21T04:06:35.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.0 mtime 2025-03-21T05:43:25.000000-0500, size 0\nkerala.rgw.buckets.index/.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.7 mtime 2025-03-21T04:06:35.000000-0500, size 0\n"})}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"Each of this rados object have omaps. The KEY of each omap is the name of the S3 object, and the VALUE holds some basic metadata of that object"}),"\n"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:'For example, we have uploaded one object \'object1\' to the bucket using s3cmd\n\n# s3cmd ls s3://kjbucket\n2025-03-21 13:27          349  s3://kjbucket/object1\n\nIf we list the omapkeys for the bucket index object, we will see the KEY with name \'object1\' in one of the omap\n\nfor i in $(rados -p kerala.rgw.buckets.index ls); do echo $i; rados -p kerala.rgw.buckets.index listomapkeys $i; done\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.9\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.3\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.5\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.10\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.8\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.4\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.2  object1\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.6\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.1\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.0\n.dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.7\n\nTo see the VALUE for the above KEY:\n\n# rados -p kerala.rgw.buckets.index listomapvals .dir.1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1.2\nobject1\nvalue (235 bytes) :\n00000000  08 03 e5 00 00 00 07 00  00 00 6f 62 6a 65 63 74  |..........object|\n00000010  31 09 00 00 00 00 00 00  00 01 07 03 68 00 00 00  |1...........h...|\n00000020  01 5d 01 00 00 00 00 00  00 3b 69 dd 67 fa 35 37  |.].......;i.g.57|\n00000030  1d 20 00 00 00 64 36 33  65 64 30 62 61 63 64 61  |. ...d63ed0bacda|\n00000040  35 66 37 37 61 38 31 66  36 65 32 38 63 62 38 34  |5f77a81f6e28cb84|\n00000050  30 37 66 66 33 02 00 00  00 6b 6a 02 00 00 00 6b  |07ff3....kj....k|\n00000060  6a 0a 00 00 00 74 65 78  74 2f 70 6c 61 69 6e 5d  |j....text/plain]|\n00000070  01 00 00 00 00 00 00 00  00 00 00 08 00 00 00 53  |...............S|\n00000080  54 41 4e 44 41 52 44 00  00 00 00 00 00 00 00 00  |TANDARD.........|\n00000090  01 01 02 00 00 00 25 09  01 40 00 00 00 31 38 34  |......%..@...184|\n000000a0  37 63 31 64 32 2d 61 34  32 39 2d 34 61 30 31 2d  |7c1d2-a429-4a01-|\n000000b0  61 36 35 62 2d 33 30 65  61 63 33 38 39 33 65 31  |a65b-30eac3893e1|\n000000c0  65 2e 32 34 35 31 30 30  2e 31 34 35 37 39 33 30  |e.245100.1457930|\n000000d0  32 38 31 37 34 36 36 31  31 37 37 34 38 00 00 00  |2817466117748...|\n000000e0  00 00 00 00 00 00 00 00  00 00 00                 |...........|\n000000eb\n\nYou can also use *radosgw-admin bi list* command to list the metadata stored for all the s3 objects in the omap of index objects of the bucket\n# radosgw-admin bi list --bucket kjbucket --object object1\n[\n    {\n        "type": "plain",\n        "idx": "object1",\n        "entry": {\n            "name": "object1",\n            "instance": "",\n            "ver": {\n                "pool": 37,\n                "epoch": 9\n            },\n            "locator": "",\n            "exists": true,\n            "meta": {\n                "category": 1,\n                "size": 349,\n                "mtime": "2025-03-21T13:27:23.490157Z",\n                "etag": "d63ed0bacda5f77a81f6e28cb8407ff3",\n                "storage_class": "STANDARD",\n                "owner": "kj",\n                "owner_display_name": "kj",\n                "content_type": "text/plain",\n                "accounted_size": 349,\n                "user_data": "",\n                "appendable": false\n            },\n            "tag": "1847c1d2-a429-4a01-a65b-30eac3893e1e.245100.14579302817466117748",\n            "flags": 0,\n            "pending_map": [],\n            "versioned_epoch": 0\n        }\n    }\n]\n\n\n'})}),"\n",(0,t.jsx)(a.h2,{id:"data",children:"DATA"}),"\n",(0,t.jsx)(a.p,{children:"The actual s3objects are stored in the rgw.buckets.data pool."}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"# rados -p kerala.rgw.buckets.data ls\n1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1_object1\n"})}),"\n",(0,t.jsx)(a.p,{children:"It could be stored in one or more RADOS objects for each RGW object depending on the object size.\n(RGW/RADOS objects are 4MB by default. Anything larger that will be split to multiple objects)"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"For example if we upload 10MB s3object file to the bucket, it will be split as :\n\n# s3cmd put 10mb_object s3://kjbucket\nupload: '10mb_object' -> 's3://kjbucket/10mb_object'  [1 of 1]\n 10485760 of 10485760   100% in    0s    49.61 MB/s  done\n\n# rados -p kerala.rgw.buckets.data ls\n1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1_10mb_object\n1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1__shadow_.3RXYVnUwzlNxZ4byiE66Pgb0593fydH_2\n1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1__shadow_.3RXYVnUwzlNxZ4byiE66Pgb0593fydH_1\n\n# stat\nkerala.rgw.buckets.data/1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1_10mb_object mtime 2025-03-21T08:49:43.000000-0500, size 4194304\nkerala.rgw.buckets.data/1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1__shadow_.3RXYVnUwzlNxZ4byiE66Pgb0593fydH_2 mtime 2025-03-21T08:49:43.000000-0500, size 2097152\nkerala.rgw.buckets.data/1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1__shadow_.3RXYVnUwzlNxZ4byiE66Pgb0593fydH_1 mtime 2025-03-21T08:49:43.000000-0500, size 4194304\n"})}),"\n",(0,t.jsxs)(a.p,{children:["An RGW object may comprise multiple RADOS objects, the first of which is the ",(0,t.jsx)(a.em,{children:"HEAD"})," that contains metadata including manifest, ACLs, content type, ETag, and user-defined metadata."]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:"# for i in $(rados -p kerala.rgw.buckets.data listxattr 1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1_object1); do echo $i && rados -p kerala.rgw.buckets.data getxattr 1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1_10mb_object $i  | hexdump -C ; done\nuser.rgw.acl\n00000000  02 02 6f 00 00 00 03 02  0c 00 00 00 02 00 00 00  |..o.............|\n00000010  6b 6a 02 00 00 00 6b 6a  04 03 57 00 00 00 01 01  |kj....kj..W.....|\n00000020  00 00 00 02 00 00 00 6b  6a 0f 00 00 00 01 00 00  |.......kj.......|\n00000030  00 02 00 00 00 6b 6a 05  03 30 00 00 00 02 02 04  |.....kj..0......|\n00000040  00 00 00 00 00 00 00 02  00 00 00 6b 6a 00 00 00  |...........kj...|\n00000050  00 00 00 00 00 02 02 04  00 00 00 0f 00 00 00 02  |................|\n00000060  00 00 00 6b 6a 00 00 00  00 00 00 00 00 00 00 00  |...kj...........|\n00000070  00 00 00 00 00 0a                                 |......|\n00000076\nuser.rgw.content_type\n00000000  61 70 70 6c 69 63 61 74  69 6f 6e 2f 6f 63 74 65  |application/octe|\n00000010  74 2d 73 74 72 65 61 6d  00 0a                    |t-stream..|\n0000001a\nuser.rgw.etag\n00000000  66 31 63 39 36 34 35 64  62 63 31 34 65 66 64 64  |f1c9645dbc14efdd|\n00000010  63 37 64 38 61 33 32 32  36 38 35 66 32 36 65 62  |c7d8a322685f26eb|\n00000020  0a                                                |.|\n00000021\nuser.rgw.idtag\n00000000  31 38 34 37 63 31 64 32  2d 61 34 32 39 2d 34 61  |1847c1d2-a429-4a|\n00000010  30 31 2d 61 36 35 62 2d  33 30 65 61 63 33 38 39  |01-a65b-30eac389|\n00000020  33 65 31 65 2e 32 34 35  31 30 30 2e 36 37 38 37  |3e1e.245100.6787|\n00000030  37 36 39 33 34 33 39 35  37 35 39 37 38 36 33 00  |769343957597863.|\n00000040  0a                                                |.|\n00000041\nuser.rgw.manifest\n00000000  08 06 61 01 00 00 00 00  a0 00 00 00 00 00 00 00  |..a.............|\n00000010  00 00 00 06 06 90 00 00  00 0a 0a 73 00 00 00 08  |...........s....|\n00000020  00 00 00 6b 6a 62 75 63  6b 65 74 2d 00 00 00 31  |...kjbucket-...1|\n00000030  38 34 37 63 31 64 32 2d  61 34 32 39 2d 34 61 30  |847c1d2-a429-4a0|\n00000040  31 2d 61 36 35 62 2d 33  30 65 61 63 33 38 39 33  |1-a65b-30eac3893|\n00000050  65 31 65 2e 31 31 35 30  37 35 2e 31 2d 00 00 00  |e1e.115075.1-...|\n00000060  31 38 34 37 63 31 64 32  2d 61 34 32 39 2d 34 61  |1847c1d2-a429-4a|\n00000070  30 31 2d 61 36 35 62 2d  33 30 65 61 63 33 38 39  |01-a65b-30eac389|\n00000080  33 65 31 65 2e 31 31 35  30 37 35 2e 31 00 00 00  |3e1e.115075.1...|\n00000090  00 00 00 00 00 00 0b 00  00 00 31 30 6d 62 5f 6f  |..........10mb_o|\n000000a0  62 6a 65 63 74 00 00 00  00 00 00 40 00 00 00 00  |bject......@....|\n000000b0  00 00 00 40 00 00 00 00  00 21 00 00 00 2e 33 52  |...@.....!....3R|\n000000c0  58 59 56 6e 55 77 7a 6c  4e 78 5a 34 62 79 69 45  |XYVnUwzlNxZ4byiE|\n000000d0  36 36 50 67 62 30 35 39  33 66 79 64 48 5f 01 00  |66Pgb0593fydH_..|\n000000e0  00 00 00 00 00 00 00 00  00 00 02 01 20 00 00 00  |............ ...|\n000000f0  00 00 00 00 00 00 40 00  00 00 00 00 00 00 00 00  |......@.........|\n*\n00000110  00 00 11 00 00 00 64 65  66 61 75 6c 74 2d 70 6c  |......default-pl|\n00000120  61 63 65 6d 65 6e 74 11  00 00 00 64 65 66 61 75  |acement....defau|\n00000130  6c 74 2d 70 6c 61 63 65  6d 65 6e 74 00 00 00 00  |lt-placement....|\n00000140  02 02 21 00 00 00 04 00  00 00 6e 6f 6e 65 03 01  |..!.......none..|\n00000150  12 00 00 00 00 00 00 00  00 00 00 00 00 00 01 00  |................|\n00000160  00 00 00 00 00 00 00 0a                           |........|\n00000168\nuser.rgw.pg_ver\n00000000  0b 00 00 00 00 00 00 00  0a                       |.........|\n00000009\nuser.rgw.source_zone\n00000000  49 88 fa a4 0a                                    |I....|\n00000005\nuser.rgw.tail_tag\n00000000  31 38 34 37 63 31 64 32  2d 61 34 32 39 2d 34 61  |1847c1d2-a429-4a|\n00000010  30 31 2d 61 36 35 62 2d  33 30 65 61 63 33 38 39  |01-a65b-30eac389|\n00000020  33 65 31 65 2e 32 34 35  31 30 30 2e 36 37 38 37  |3e1e.245100.6787|\n00000030  37 36 39 33 34 33 39 35  37 35 39 37 38 36 33 00  |769343957597863.|\n00000040  0a                                                |.|\n00000041\nuser.rgw.x-amz-meta-s3cmd-attrs\n00000000  61 74 69 6d 65 3a 31 37  34 32 35 36 34 39 36 35  |atime:1742564965|\n00000010  2f 63 74 69 6d 65 3a 31  37 34 32 35 36 34 39 36  |/ctime:174256496|\n00000020  35 2f 67 69 64 3a 30 2f  67 6e 61 6d 65 3a 72 6f  |5/gid:0/gname:ro|\n00000030  6f 74 2f 6d 64 35 3a 66  31 63 39 36 34 35 64 62  |ot/md5:f1c9645db|\n00000040  63 31 34 65 66 64 64 63  37 64 38 61 33 32 32 36  |c14efddc7d8a3226|\n00000050  38 35 66 32 36 65 62 2f  6d 6f 64 65 3a 33 33 31  |85f26eb/mode:331|\n00000060  38 38 2f 6d 74 69 6d 65  3a 31 37 34 32 35 36 34  |88/mtime:1742564|\n00000070  39 36 35 2f 75 69 64 3a  30 2f 75 6e 61 6d 65 3a  |965/uid:0/uname:|\n00000080  72 6f 6f 74 00 0a                                 |root..|\n00000086\n"})}),"\n",(0,t.jsx)(a.p,{children:"The manifest which is stored as xattr as show above, describes how each RGW object is laid out across RADOS objects.\nAnother easy command to see the object manifest is :"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{children:'# radosgw-admin object manifest --bucket kjbucket --object 10mb_object\n{\n    "size": 10485760,\n    "objects": [\n        {\n            "index": 0,\n            "part_id": 0,\n            "stripe_id": 0,\n            "offset": 0,\n            "size": 4194304,\n            "raw_obj": {\n                "pool": "kerala.rgw.buckets.data",\n                "oid": "1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1_10mb_object",\n                "loc": ""\n            }\n        },\n        {\n            "index": 1,\n            "part_id": 0,\n            "stripe_id": 1,\n            "offset": 4194304,\n            "size": 4194304,\n            "raw_obj": {\n                "pool": "kerala.rgw.buckets.data",\n                "oid": "1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1__shadow_.3RXYVnUwzlNxZ4byiE66Pgb0593fydH_1",\n                "loc": ""\n            }\n        },\n        {\n            "index": 2,\n            "part_id": 0,\n            "stripe_id": 2,\n            "offset": 8388608,\n            "size": 4194304,\n            "raw_obj": {\n                "pool": "kerala.rgw.buckets.data",\n                "oid": "1847c1d2-a429-4a01-a65b-30eac3893e1e.115075.1__shadow_.3RXYVnUwzlNxZ4byiE66Pgb0593fydH_2",\n                "loc": ""\n            }\n        }\n    ]\n}\n'})}),"\n",(0,t.jsx)(a.p,{children:"So how does a Multipart read works?"}),"\n",(0,t.jsx)(a.p,{children:"When a request comes, it goes to the HEAD object.\nThe manifest stored as xattr in the HEAD object has the list of its shadow objects.\nThen RGW combines these objects."})]})}function l(e={}){const{wrapper:a}={...(0,d.R)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(b,{...e})}):b(e)}},8453:(e,a,n)=>{n.d(a,{R:()=>s,x:()=>i});var t=n(6540);const d={},c=t.createContext(d);function s(e){const a=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:s(e.components),t.createElement(c.Provider,{value:a},e.children)}}}]);