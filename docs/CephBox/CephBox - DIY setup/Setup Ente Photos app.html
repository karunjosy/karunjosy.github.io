<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-CephBox/CephBox - DIY setup/Setup Ente Photos app" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Setup Ente Photos app | An idea is just a thought until it is written down.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://karunjosy.github.io/img/cephboximage.png"><meta data-rh="true" name="twitter:image" content="https://karunjosy.github.io/img/cephboximage.png"><meta data-rh="true" property="og:url" content="https://karunjosy.github.io/docs/CephBox/CephBox - DIY setup/Setup Ente Photos app"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Setup Ente Photos app | An idea is just a thought until it is written down."><meta data-rh="true" name="description" content="Ente Photos  app is a fully open source, end-to-end encrypted platform  to store your photos(an open source alternative to Apple and Google Photos).Ente photos can be also used to Self-host and integrate with any S3 compatible storage platform like Ceph RGW."><meta data-rh="true" property="og:description" content="Ente Photos  app is a fully open source, end-to-end encrypted platform  to store your photos(an open source alternative to Apple and Google Photos).Ente photos can be also used to Self-host and integrate with any S3 compatible storage platform like Ceph RGW."><link data-rh="true" rel="canonical" href="https://karunjosy.github.io/docs/CephBox/CephBox - DIY setup/Setup Ente Photos app"><link data-rh="true" rel="alternate" href="https://karunjosy.github.io/docs/CephBox/CephBox - DIY setup/Setup Ente Photos app" hreflang="en"><link data-rh="true" rel="alternate" href="https://karunjosy.github.io/docs/CephBox/CephBox - DIY setup/Setup Ente Photos app" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="An idea is just a thought until it is written down. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="An idea is just a thought until it is written down. Atom Feed"><link rel="stylesheet" href="/assets/css/styles.78880c06.css">
<script src="/assets/js/runtime~main.7b12fbe0.js" defer="defer"></script>
<script src="/assets/js/main.00569416.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/CephBox/Introduction/What is Cephbox">CephBox</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/karunjosy/CephBox" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/CephBox/Introduction/What is Cephbox">CephBox : A Home Cloud solution</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/introdutction">Introduction</a><button aria-label="Expand sidebar category &#x27;Introduction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/DIY">DIY Setup</a><button aria-label="Collapse sidebar category &#x27;DIY Setup&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CephBox/CephBox - DIY setup/Intro">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CephBox/CephBox - DIY setup/Setting up Raspberry Pi OS">Setting up Raspberry Pi OS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CephBox/CephBox - DIY setup/Installing Ceph Cluster">Installing Ceph Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/CephBox/CephBox - DIY setup/Setup Ente Photos app">Setup Ente Photos app</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CephBox/CephBox - DIY setup/Setup Nextcloud with Ceph RGW">Setup Nextcloud with Ceph RGW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CephBox/CephBox - DIY setup/Automatic Setup">Automatic Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CephBox/CephBox - DIY setup/Troubleshooting Doc">Troubleshooting Doc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CephBox/CephBox - DIY setup/test2">test2</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/DIY"><span itemprop="name">DIY Setup</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Setup Ente Photos app</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Setup Ente Photos app</h1></header><p><a href="https://github.com/ente-io/ente" target="_blank" rel="noopener noreferrer">Ente Photos</a>  app is a fully open source, end-to-end encrypted platform  to store your photos(an open source alternative to Apple and Google Photos).Ente photos can be also used to <a href="https://help.ente.io/self-hosting/" target="_blank" rel="noopener noreferrer">Self-host</a> and integrate with any S3 compatible storage platform like Ceph RGW.</p>
<p><em>Huge shout-out to the Ente team for their awesomeness!</em></p>
<p>We are using Ente Photos app to store our photos integrating with the Ceph Cluster that we have built.</p>
<p>Okay, now here are some bare minimum basics of Ente architecture to get started.</p>
<p>There are three major Components in Ente platform:</p>
<ol>
<li><strong>Ente desktop and mobile app</strong> --&gt; This is the user interface</li>
<li><strong>Ente Musuem server with Postgress</strong> --&gt; Stateless API server which manages the access of data</li>
<li><strong>Ceph RGW external</strong> --&gt; This is where the actual data is stored in S3 buckets</li>
</ol>
<p>For the uploads to work, all three of them need to be able to reach each other. This is because the client uploads directly to the object storage. The interaction goes something like this:</p>
<ul>
<li>Client wants to upload, it asks museum where it should upload to.</li>
<li>Museum creates pre-signed URLs for the S3 bucket that was configured.</li>
<li>Client directly uploads to the S3 buckets using these URLs.</li>
</ul>
<p>Read more about Museum and Ente architecture <a href="https://help.ente.io/self-hosting/guides/configuring-s3" target="_blank" rel="noopener noreferrer">here</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ente-desktop-app-and-mobile-app">Ente desktop app and mobile app<a href="#ente-desktop-app-and-mobile-app" class="hash-link" aria-label="Direct link to Ente desktop app and mobile app" title="Direct link to Ente desktop app and mobile app">​</a></h2>
<ul>
<li>You can download and install the desktop app from their official <a href="https://ente.photos/" target="_blank" rel="noopener noreferrer">website</a>.</li>
<li>To use it in your mobile phone, you can install the android app from <a href="https://play.google.com/store/apps/details?id=io.ente.photos&amp;hl=en_IN" target="_blank" rel="noopener noreferrer">playstore</a></li>
</ul>
<p>By default if you login, the app will connect to Ente&#x27;s production server endpoint which is not what we want.
For self-hosting, we need to provide our local endpoint. Now here is the trick;
<span style="background-color:#106b51;border-radius:2px;color:#fff;padding:0.2rem"><strong>tap 7 times on the onboarding screen</strong> </span> and  to bring up developer settings
page where you can configure the endpoint the app should be connecting to.</p>
<img src="/img/ente_developer_page.png" alt="Sample Image" width="500" height="300">
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-ente-musuem-server-with-postgress">Deploying Ente Musuem server with Postgress<a href="#deploying-ente-musuem-server-with-postgress" class="hash-link" aria-label="Direct link to Deploying Ente Musuem server with Postgress" title="Direct link to Deploying Ente Musuem server with Postgress">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Info:</div><div class="admonitionContent_BuS1"><p>There are couple of different ways to install Ente server as documented <a href="https://github.com/ente-io/ente/blob/main/server/RUNNING.md" target="_blank" rel="noopener noreferrer">here</a>.  We are using <a href="https://github.com/ente-io/ente/blob/main/server/docs/docker.md" target="_blank" rel="noopener noreferrer">published Docker image</a> method.</p></div></div>
<p>Steps:</p>
<ol>
<li>
<p>In one of the Raspberry Pi machine create a directory where you&#x27;ll run Ente</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mkdir ente &amp;&amp; cd ente</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Copy the starter <em>compose.yaml</em> and  its support files from the repository onto your directory. You can do it by hand, or use (e.g.) curl</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; compose.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># curl -LO https://raw.githubusercontent.com/karunjosy/CephBox/refs/heads/main/ente_with_ceph/compose.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># mkdir -p scripts/compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cd scripts/compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; scripts/compose/credentials.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># curl -LO https://raw.githubusercontent.com/karunjosy/CephBox/refs/heads/main/ente_with_ceph/credentials.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cd ../..</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Note</div><div class="admonitionContent_BuS1"><p>The above files are customized to get Musuem server running with Ceph as backend.
Read more about these services <a href="https://github.com/ente-io/ente/blob/main/server/docs/docker.md" target="_blank" rel="noopener noreferrer">here</a></p></div></div>
<ul>
<li>
<p>Here is a sample for compose.yaml</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  museum:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: ghcr.io/ente-io/server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - 8080:8080 # API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - 2112:2112 # Prometheus metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    depends_on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      postgres:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        condition: service_healthy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # Pass-in the config to connect to the DB and MinIO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ENTE_CREDENTIALS_FILE: /credentials.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - custom-logs:/var/logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - ./museum.yaml:/museum.yaml:ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - ./scripts/compose/credentials.yaml:/credentials.yaml:ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - ./data:/data:ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  postgres:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: postgres:15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - 5432:5432</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      POSTGRES_USER: pguser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      POSTGRES_PASSWORD: pgpass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      POSTGRES_DB: ente_db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Wait for postgres to be accept connections before starting museum.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    healthcheck:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      test:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;CMD&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;pg_isready&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;-q&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;-d&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;ente_db&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;-U&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;pguser&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      start_period: 40s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      start_interval: 1s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - postgres-data:/var/lib/postgresql/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  custom-logs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  postgres-data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  internal:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>scripts/compose/credentials.yaml sample:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">db:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    host: postgres</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port: 5432</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: ente_db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user: pguser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    password: pgpass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    are_local_buckets: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b2-eu-cen:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        key: &lt;access_key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secret: &lt;secret_key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        endpoint: 10.x.x.x:80 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        region: eu-central-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bucket: test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>
<p>Edit the credentials.yaml to add the ceph RGW endpoint and bucket details. You may also edit the postgres password.</p>
</li>
<li>
<p>Install docker and docker-compose if not present</p>
<ul>
<li>docker-compose :</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># apt install docker.io -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># curl -L &quot;https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  chmod +x /usr/local/bin/docker-compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  docker-compose --version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Docker Compose version v2.29.7</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>docker engine install</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># apt install ca-certificates curl gnupg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  install -m 0755 -d /etc/apt/keyrings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sudo chmod a+r /etc/apt/keyrings/docker.gpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># echo &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># apt install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># docker version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Version:           27.3.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create RGW user and bucket. You may refer the steps <a href="http://karunjosyin.github.com" target="_blank" rel="noopener noreferrer">here</a></p>
</li>
<li>
<p>Set CORS for the bucket created</p>
<ul>
<li>
<p>Create cors.xml file</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;CORSConfiguration&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;CORSRule&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;AllowedOrigin&gt;*&lt;/AllowedOrigin&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;AllowedMethod&gt;GET&lt;/AllowedMethod&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;AllowedMethod&gt;HEAD&lt;/AllowedMethod&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;AllowedMethod&gt;POST&lt;/AllowedMethod&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;AllowedMethod&gt;PUT&lt;/AllowedMethod&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;AllowedMethod&gt;DELETE&lt;/AllowedMethod&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;AllowedHeader&gt;*&lt;/AllowedHeader&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;ExposeHeader&gt;Etag&lt;/ExposeHeader&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;MaxAgeSeconds&gt;3000&lt;/MaxAgeSeconds&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/CORSRule&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/CORSConfiguration&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>apply it to the bucket using s3cmd</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">s3cmd setcors cors.xml s3://test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>Note : To install s3cmd client refer <a href="https://karunjosy.github.io/docs/CephBox/CephBox%20-%20DIY%20setup/Troubleshooting%20Doc#install-s3cmd-to-set-cors" target="_blank" rel="noopener noreferrer">here</a></p>
</li>
<li>
<p>compose.yaml starts museum and postgress containers by pulling container images.
From the <em>ente</em> directory run</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>or if you want to run the process in background</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nohup docker-compose up &amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open the mobile or desktop app and tap 7 times and enter the endpoint</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://&lt;IP&gt;:8080</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create an account and upload your first photo!</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Note</div><div class="admonitionContent_BuS1"><p>You will get the OTP send to the email ID from the museum container log.
To create and manage accounts, refer here</p></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-settings-for-better-user-experience">Additional settings for better user experience<a href="#additional-settings-for-better-user-experience" class="hash-link" aria-label="Direct link to Additional settings for better user experience" title="Direct link to Additional settings for better user experience">​</a></h2>
<p>If you have reached here, it means you will have a working setup to test around. But if you are planning to use it in real life, we need to do some additional settings, mainly</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="hard-coded-otp">Hard-coded OTP<a href="#hard-coded-otp" class="hash-link" aria-label="Direct link to Hard-coded OTP" title="Direct link to Hard-coded OTP">​</a></h4>
<p>You can hard-code the OTP that gets sent to the first user account so that you don&#x27;t require to review the logs to get them.
Add this to scripts/compose/credentials.yaml file</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">internal:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    silent: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    health-check-url:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hardcoded-ott:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emails:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - &quot;example@example.org,123456&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #     # When running in a local environment, hardcode the verification code to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #     # 123456 for email addresses ending with @example.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        local-domain-suffix: &quot;@example.org&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        local-domain-value: 123456</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # List of user IDs that can use the admin API endpoints.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # If this is not set, as a fallback, the first user is considered an admin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    admins: []</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="increase-storage-space-for-the-users">Increase storage space for the users<a href="#increase-storage-space-for-the-users" class="hash-link" aria-label="Direct link to Increase storage space for the users" title="Direct link to Increase storage space for the users">​</a></h4>
<p>By default, user will have only the 5GB quota assoicated with the free plan.
In self-hosting environment such as ours, we can custom set the quota for the users.</p>
<p>This procedure is bit an overhead as of now, but we would need to do this procedure couple of times.</p>
<p>First, we have to configure ente-cli administration tool</p>
<ul>
<li>
<p>Build docker image from Github source</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># git clone https://github.com/ente-io/ente</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cd ente/cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Modify the docker-compose.yml and add volume. cli-data volume is mandatory, you can add more volumes for your export directory.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># docker-compose up -d --build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>We need to get  CLI to connect to the custom museum server.
Define a config.yaml and put it either in the same directory as CLI or inside the container</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker exec -it cli-ente-cli-1 /bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vi config.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  endpoint:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    api: &quot;http://&lt;IP&gt;:8080&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add the existing user as an admin account.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ./ente-cli account add</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter app type (default: photos):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Use default app type: photos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter export directory: data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter email address: example@example.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Please wait authenticating...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account added successfully</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Get the ID of the user</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ./ente-cli account list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Configured accounts: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Email:     example@example.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ID:        1580559962386438</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">App:       photos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExportDir: data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====================================</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add the ID to scripts/compose/credentials.yaml file we used to compose the museum server</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">internal:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    silent: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    health-check-url:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hardcoded-ott:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emails:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - &quot;example@example.org,123456&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #     # When running in a local environment, hardcode the verification code to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #     # 123456 for email addresses ending with @example.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        local-domain-suffix: &quot;@example.org&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        local-domain-value: 123456</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # List of user IDs that can use the admin API endpoints.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # If this is not set, as a fallback, the first user is considered an admin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    admins:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - 1580559962386438</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Restart the museum container or redo docker-compose</p>
</li>
<li>
<p>Increase the Quota for the user from ente-cli container</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ./ente-cli admin update-subscription -a example@example.org -u example@example.org --no-limit False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Enter a storage size (e.g.&#x27;5MB&#x27;, &#x27;10GB&#x27;, &#x27;2Tb&#x27;): : 100GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Enter sub expiry date in YYYY-MM-DD format  (e.g.&#x27;2040-12-31&#x27;): 2040-12-31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Updating storage for user example@example.org to 100.0 GB (old 5.0 GB) with new expirty 2040-12-31 (old 2124-11-15)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Are you sure you want to update the storage (&#x27;y&#x27; or &#x27;n&#x27;)?: y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Successfully updated storage and expiry date for user</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CephBox/CephBox - DIY setup/Setup Ente Photos app.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/CephBox/CephBox - DIY setup/Installing Ceph Cluster"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Installing Ceph Cluster</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/CephBox/CephBox - DIY setup/Setup Nextcloud with Ceph RGW"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Setup Nextcloud with Ceph RGW</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ente-desktop-app-and-mobile-app" class="table-of-contents__link toc-highlight">Ente desktop app and mobile app</a></li><li><a href="#deploying-ente-musuem-server-with-postgress" class="table-of-contents__link toc-highlight">Deploying Ente Musuem server with Postgress</a></li><li><a href="#additional-settings-for-better-user-experience" class="table-of-contents__link toc-highlight">Additional settings for better user experience</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/cephbox">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://instagram.com/karun.josy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/karun-josy-5a681481/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/karunjosy" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>